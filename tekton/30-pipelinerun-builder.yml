---
apiVersion: tekton.dev/v1beta1
kind: PipelineRun
metadata:
  name: pack-build-builder-push-run
spec:
  pipelineRef:
    name: pack-build-builder-push
  params:
    - name: gitUbiBuilderUrl
      value: https://github.com/redhat-buildpacks/ubi-image-builder.git
    - name: packCmdBuilderArgs
      value:
      - builder
      - create
      - -v
      - quay.io/swowdrop/ubi-builder
      - --config
      - $(workspaces.source-dir.path)/ubi-builder.toml
      - --publish

  workspaces:
    - name: source-dir
      persistentVolumeClaim:
        claimName: ubi-builder-vol
    - name: pack-workspace
      persistentVolumeClaim:
        claimName: pack-workspace-vol
    - name: data-store
      projected:
        sources:
          - configMap:
              name: pack-config-toml
